import{_ as f}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as p,a as h}from"./VRow-1IsH-HXB.js";import{v as _,o as d,e as i,w as t,b as a,a3 as g,H as k,t as V,au as x,a as y,V as m}from"./main-6un_LZV3.js";import{V as b}from"./VDataTable-BLZgC8uG.js";import{a as w}from"./VSnackbar-DYX9Ldxv.js";import{d as C}from"./VTextField-DkY_PXxT.js";const v={name:"PaymentsRow",props:{modulo:String,records:{type:Array,default(){return[]}}},emits:["update-total"],data:()=>({showFooter:!1,paymentMethods:[],payments:[],route:"payments",headers:[{title:"",key:"actions",align:"center",width:"100px"},{title:"Id",key:"index",align:" d-none"},{title:"Metodo de pago",key:"payment_method_id",align:"center"},{title:"Importe",key:"amount",align:"center"}],keyTablePayments:0}),computed:{totalLocal(){return console.log(this.payments.reduce((e,o)=>e+Number(o.amount||0),0)),this.payments.reduce((e,o)=>e+Number(o.amount||0),0)}},watch:{totalLocal(e){this.$emit("update-total",e)}},created(){this.loadData(),this.records.length>0?this.payments=this.records:this.add()},methods:{onlyNumberInput(e){const o=String.fromCharCode(e.keyCode);/[0-9.]/.test(o)||e.preventDefault()},add(){var e=this.payments.length;this.payments.push({payment_method_id:"",amount:"",index:e})},remove(e){let o=e.index,c=this.payments.findIndex(u=>u.index===o);this.payments.splice(c,1)},reset(){this.payments=[]},resetRow(e){this.payments[e].payment_method_id="",this.payments[e].amount=""},async loadData(){try{const[e]=await Promise.all([this.$axios.get(this.$routes.paymentMethods)]);this.paymentMethods=e.data.data||e.data}catch(e){console.error("Error loading data:",e),this.showSnackbar("Error al cargar los datos","error")}}}},I={class:"d-flex justify-center"},R={class:"d-flex gap-0 px-0 mx-0"};function M(e,o,c,u,N,l){const r=_("IconBtn");return e.payments.length?(d(),i(h,{key:1,justify:"center"},{default:t(()=>[a(p,{cols:"12",md:"12",sm:"12",class:"text-center"},{default:t(()=>[(d(),i(b,{headers:e.headers,items:e.payments,key:e.keyTablePayments,"hide-default-footer":!0},x({"item.payment_method_id":t(({item:s})=>[y("div",I,[a(w,{class:"mx-auto",items:e.paymentMethods,"item-value":"id","item-title":"name",label:s.payment_method_id?"":"Metodo de Pago",modelValue:s.payment_method_id,"onUpdate:modelValue":n=>s.payment_method_id=n,rules:[e.$rulesRequerido],"return-object":"",density:"compact","hide-details":"",style:{"max-width":"350px"}},null,8,["items","label","modelValue","onUpdate:modelValue","rules"])])]),"item.amount":t(({item:s})=>[a(C,{class:"text-left",modelValue:s.amount,"onUpdate:modelValue":n=>s.amount=n,label:s.amount?"":"Importe",rules:[e.$rulesRequerido],required:"",density:"compact","hide-details":"",onKeypress:l.onlyNumberInput},null,8,["modelValue","onUpdate:modelValue","label","rules","onKeypress"])]),"item.actions":t(({item:s})=>[y("div",R,[a(r,{color:"warning",size:"x-small",title:"Reset",onClick:n=>l.resetRow(s.index)},{default:t(()=>[a(m,{icon:"ri-refresh-line"})]),_:2},1032,["onClick"]),a(r,{color:"error",size:"x-small",title:"Eliminar Pago",onClick:n=>l.remove(s)},{default:t(()=>[a(m,{icon:"ri-subtract-line"})]),_:2},1032,["onClick"]),a(r,{color:"success",size:"x-small",title:"Agregar Pago",onClick:o[0]||(o[0]=n=>l.add())},{default:t(()=>[a(m,{icon:"ri-add-line"})]),_:1})])]),_:2},[e.showFooter?void 0:{name:"bottom",fn:t(()=>[]),key:"0"}]),1032,["headers","items"]))]),_:1})]),_:1})):(d(),i(h,{key:0,dense:"",align:"center"},{default:t(()=>[a(p,{cols:"12",md:"12",sm:"12"},{default:t(()=>[a(g,{small:"",color:"primary",onClick:l.add,dark:""},{default:t(()=>[k(" Agregar "+V(this.modulo),1)]),_:1},8,["onClick"])]),_:1})]),_:1}))}const A=f(v,[["render",M],["__scopeId","data-v-3406e0d5"]]);export{A as _};
