import{_ as G}from"./PaymentsRow-BwfwuWpv.js";import{_ as B}from"./DateRangeField-CT4VxqGP.js";import{at as j,v as H,o as C,e as V,w as t,b as e,a as o,V as D,t as c,c as A,l as O,n as Y,H as d,a0 as N,a3 as v,F as q,x as J,y as K}from"./main-CfrpDZi-.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as x,c as T,V as b,d as E}from"./VCard-DVwodv2h.js";import{V as W}from"./VDataTable-DLw8rx2W.js";import{a as y,V as m}from"./VRow-Cz0MKRVd.js";import{d as X}from"./VTextField-gwJ-RELe.js";import{a as k,b as I,c as U,V as Z}from"./VSnackbar-wVsU0d4B.js";import{V as S}from"./VAvatar-C-r1MgBS.js";import{e as w,V as $,a as ee,b as P,c as R}from"./VChip-Dp1dXxCw.js";import{V as L}from"./VDialog-CiapdF1O.js";import{V as F}from"./VSpacer-B0QkxMKc.js";import{V as z}from"./VForm-1HDHUL29.js";import{V as te}from"./VContainer-CFIbZh8g.js";import{V as M}from"./VDivider-CfaZRtKR.js";import{V as se}from"./VAlert-Cv26Rtxj.js";import"./VImg-BU7YZlzI.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-N9xuIT-z.js";import"./easing-DY7PVvcf.js";import"./lazy-Cx6JvYiO.js";import"./VCheckboxBtn-wgB4PCGe.js";import"./VTable-Dx6GtFvT.js";import"./index-CPT9JW-W.js";import"./ssrBoot-l9uIrCew.js";const ae={components:{DateRangeField:B},data(){return{keyPayments:1,validPayment:!1,savingPayment:!1,change:0,totalPaid:0,payment:{amount:0,payment_method_id:null,notes:""},selectedDate:null,dateRange:{start:null,end:null},dateOrderRange:{start:null,end:null},loading:!1,search:"",customers:[],orders:[],paymentStatuses:[],shipmentStatuses:[],selectedCustomer:null,selectedPaymentStatus:null,selectedShipmentStatus:null,selectedOrder:null,movementDialog:!1,paymentFormDialog:!1,validMovement:!1,savingMovement:!1,movement:{status_id:null},snackbar:!1,snackbarText:"",snackbarColor:"success",headers:[{title:"Acciones",key:"actions",sortable:!1,align:"center"},{title:"Orden",key:"order_number"},{title:"Fecha",key:"order_date",align:"center"},{title:"Fecha Entrega",key:"delivery_date",align:"center"},{title:"Cliente",key:"customer"},{title:"Estados",key:"payment_status_id",align:"center"},{title:"Total",key:"total_amount",align:"end"}],isAdmin:!1,createdOrder:{order:{}}}},computed:{...j({userIsAdmin:"isAdmin"}),showHeaders(){return this.headers},filteredStock(){var r,i,u,a;let s=this.orders;if(this.search){const n=this.search.toLowerCase();s=s.filter(f=>{var _;return(((_=f.order_number)==null?void 0:_.toString().toLowerCase())||"").includes(n)})}if(this.selectedCustomer&&this.selectedCustomer.length>0&&(s=s.filter(n=>{var h;const f=(h=n.customer)==null?void 0:h.id;return f!==void 0&&this.selectedCustomer.includes(f)})),this.selectedPaymentStatus&&(s=s.filter(n=>{var f;return((f=n.payment_status)==null?void 0:f.id)===this.selectedPaymentStatus})),console.log(`selectedShipmentStatus: ${this.selectedShipmentStatus}, selectedShipment: ${this.selectedShipment}`),this.selectedShipmentStatus&&(s=s.filter(n=>{var f;return((f=n.shipment_status)==null?void 0:f.id)===this.selectedShipmentStatus})),(r=this.dateRange)!=null&&r.start&&((i=this.dateRange)!=null&&i.end)){const n=this.normalizeDateToStartOfDay(this.dateRange.start).getTime(),f=this.normalizeDateToEndOfDay(this.dateRange.end).getTime();s=s.filter(h=>{const _=this.parseDdMmYyyyToDate(h.delivery_date);if(!_)return!1;const l=_.getTime();return l>=n&&l<=f})}if((u=this.dateOrderRange)!=null&&u.start&&((a=this.dateOrderRange)!=null&&a.end)){const n=this.normalizeDateToStartOfDay(this.dateOrderRange.start).getTime(),f=this.normalizeDateToEndOfDay(this.dateOrderRange.end).getTime();s=s.filter(h=>{const _=this.parseDdMmYyyyToDate(h.order_date);if(!_)return!1;const l=_.getTime();return l>=n&&l<=f})}return s},pendingAmount(){return this.createdOrder&&this.totalPaid<this.createdOrder.order.total_amount?this.createdOrder.order.total_amount-this.totalPaid:0},movementFormTitle(){return this.selectedOrder?`Orden ${this.selectedOrder.order_number}`:"Orden"}},async created(){this.checkAdmin(),this.isAdmin&&this.headers.splice(4,0,{title:"Costo",key:"total_cost",align:"end"},{title:"Ganancia",key:"total_profit",align:"end"},{title:"Pagado",key:"total_paid",align:"end"}),await this.fetchData()},methods:{openPaymentForm(s){this.keyPayments=1,this.createdOrder.order=s,this.paymentFormDialog=!0},closePaymentForm(){this.createdOrder.order={},this.paymentFormDialog=!1},updateTotal(s){this.totalPaid=s,this.change=this.totalPaid>this.createdOrder.order.total_amount?this.totalPaid-this.createdOrder.order.total_amount:0},async validatePayments(s){if(s.length<=0)return"Debe incluir al menos una modalidad de pago";const r=new Set;s.reduce((i,u)=>i+parseFloat(u.amount),0);for(const i of s){if(!i.amount||!i.payment_method_id)return"Verifique la informacion de los pagos";if(r.has(i.payment_method_id.id))return"Ha seleccionado mas de una vez el mismo metodo de pago. Metodo de pago: "+i.payment_method_id.name;r.add(i.payment_method_id.id)}return!0},async savePayment(){const s=await this.validatePayments(this.$refs.paymentsRow.payments);if(s!==!0)return this.showSnackbar(s,"error");this.savingPayment=!0;try{const r={order_id:this.createdOrder.order.id,payments:this.$refs.paymentsRow.payments};(await this.$axios.post(this.$routes.payments,r)).status==201&&(this.showSnackbar("Pago registrado exitosamente","success"),this.closePaymentForm(),this.fetchData())}catch(r){console.error("Error saving payment:",r),this.showSnackbar("Error al registrar el pago","error")}finally{this.savingPayment=!1}},checkAdmin(){this.isAdmin=this.userIsAdmin},validateStatusChange(s,r){if(!s)return"Debe seleccionar un estado";if(r==1){if(s===this.selectedOrder.payment_status_id)return"El estado de pago seleccionado es igual al estado de pago actual"}else if(s===this.selectedOrder.shipment_status_id)return"El estado de envio seleccionado es igual al estado de envio actual";return!0},normalizeDateToStartOfDay(s){const r=new Date(s);return r.setHours(0,0,0,0),r},normalizeDateToEndOfDay(s){const r=new Date(s);return r.setHours(23,59,59,999),r},parseDdMmYyyyToDate(s){if(!s)return null;const r=s.split(" ")[0],[i,u,a]=r.split("/").map(Number);return isNaN(i)||isNaN(u)||isNaN(a)?null:new Date(Date.UTC(a,u-1,i))},getCustomer(s){return s?s.firstname||s.lastname?`${s.firstname||""} ${s.lastname||""}`.trim():s.address||"Dirección no disponible":"Cliente no disponible"},formatCurrency(s){return s?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(s):"$0"},async fetchData(){this.loading=!0;try{const[s,r,i,u]=await Promise.all([this.$axios.get(this.$routes.ordersLatest),this.$axios.get(this.$routes.customers),this.$axios.get(this.$routes.paymentStatuses),this.$axios.get(this.$routes.shipmentStatuses)]);this.orders=s.data.data,this.customers=r.data.data,this.paymentStatuses=i.data.data,this.shipmentStatuses=u.data.data}catch(s){console.error("Error fetching data:",s),this.showSnackbar("Error al cargar los datos","error")}finally{this.loading=!1}},openMovementDialog(s){s?this.selectedOrder=s:this.selectedOrder=null,this.movementDialog=!0},closeMovementDialog(){var s;this.movementDialog=!1,(s=this.$refs.movementForm)==null||s.reset()},async saveMovement(){var r,i;if(await this.$refs.movementForm.validate()){this.savingMovement=!0;try{let u,a;u=`${this.$routes.orders}/${this.selectedOrder.id}`,a={data:{payment_status_id:this.movement.payment_status_id,shipment_status_id:this.movement.shipment_status_id},_method:"PUT"},await this.$axios.post(u,a),this.showSnackbar("Estado actualizado correctamente","success"),this.closeMovementDialog(),await this.fetchData()}catch(u){console.error("Error saving movement:",u),this.showSnackbar(((i=(r=u.response)==null?void 0:r.data)==null?void 0:i.message)||"Error al registrar el movimiento","error")}finally{this.savingMovement=!1}}},getStatusColor(s){return{[this.$statusOrders.PENDING]:"primary",[this.$statusOrders.PROCESS]:"warning",[this.$statusOrders.PARTIAL_PAYMENT]:"warning",[this.$statusOrders.PAID]:"success",[this.$statusOrders.COMPLETED]:"success",[this.$statusOrders.APPROVED]:"success"}[s.status.code]||"error"},getStatusCodeColor(s){return{[this.$statusOrders.PENDING]:"primary",[this.$statusOrders.PROCESS]:"warning",[this.$statusOrders.PARTIAL_PAYMENT]:"warning",[this.$statusOrders.PAID]:"success",[this.$statusOrders.COMPLETED]:"success",[this.$statusOrders.APPROVED]:"success"}[s]||"error"},isPaid(s){return[this.$statusOrders.PAID,this.$statusOrders.COMPLETED,this.$statusOrders.REJECTED,this.$statusOrders.CANCEL,this.$statusOrders.REFUND,this.$statusOrders.RETURNED].includes(s.status.code)},formatDate(s){return new Date(s).toLocaleString()},formatDateGrid(s){if(!s)return"";const[r,i]=s.split(" ");return`${r} ${i||""}`},getDate(s){return s.toLocaleString().split(" ")[0]},showSnackbar(s,r){this.snackbarText=s,this.snackbarColor=r,this.snackbar=!0},async getDeliveryReport(s){var i;try{if(!this.dateRange.start||!this.dateRange.end){this.showSnackbar("Debe seleccionar un rango de fechas de entrega","error");return}const u=(i=this.shipmentStatuses.find(l=>l.id===this.selectedShipmentStatus))==null?void 0:i.code;if(!u){this.showSnackbar("Debe seleccionar el estado de envio Pendiente para generar el reporte","error");return}if(u!=this.$statusOrders.PENDING){this.showSnackbar("Debe seleccionar el estado de envio Pendiente para generar el reporte","error");return}this.loading=!0;const a=s==1?`${this.$routes.ordersDelivery}`:`${this.$routes.ordersCustomersDelivery}`,n={start_date:this.dateRange.start,end_date:this.dateRange.end,shipment_status_id:this.selectedShipmentStatus,customers:this.selectedCustomer},f=await this.$axios.get(a,{params:n,responseType:"blob"});var r=new Blob([f.data],{type:"application/pdf"});const h=window.URL.createObjectURL(r,{oneTimeOnly:!0}),_=document.createElement("a");_.target="_blank",_.href=h,document.body.appendChild(_),_.click()}catch(u){console.error("Error generando reporte:",u),this.showSnackbar("Error al generar la reporte","error")}finally{this.loading=!1}},async showRemito(s){try{this.loading=!0;const i=await this.$axios.get(`${this.$routes.orders}/remito/${s.id}`,{responseType:"blob"});var r=new Blob([i.data],{type:"application/pdf"});const u=window.URL.createObjectURL(r,{oneTimeOnly:!0}),a=document.createElement("a");a.target="_blank",a.href=u,document.body.appendChild(a),a.click()}catch(i){console.error("Error generando factura:",i),this.showSnackbar("Error al generar la factura","error")}finally{this.loading=!1}},async showRemitoComanda(s){try{this.loading=!0;const i=await this.$axios.get(`${this.$routes.orders}/remito-comanda/${s.id}`,{responseType:"blob"});var r=new Blob([i.data],{type:"application/pdf"});const u=window.URL.createObjectURL(r,{oneTimeOnly:!0}),a=document.createElement("a");a.target="_blank",a.href=u,document.body.appendChild(a),a.click()}catch(i){console.error("Error generando factura:",i),this.showSnackbar("Error al generar la factura","error")}finally{this.loading=!1}}}},p=s=>(J("data-v-69a0768e"),s=s(),K(),s),le=p(()=>o("div",{class:"text-h5"},"Últimas Órdenes",-1)),re={class:"text-caption text-medium-emphasis d-flex align-center mt-1"},oe=p(()=>o("span",{class:"v-card-info-subtitle"}," Mostrando órdenes de los últimos 60 días ",-1)),ne={class:"d-flex align-center"},ie={class:"d-flex flex-column text-start"},de={class:"d-block font-weight-medium text-high-emphasis text-truncate"},ce={key:0},me={class:"d-flex flex-column"},ue={class:"font-weight-medium"},fe={class:"text-disabled"},he={class:"text-right text-error"},_e={class:"text-right text-success"},pe={class:"d-flex flex-column align-center gap-2"},ge={class:"d-flex justify-center align-center gap-1"},ye=p(()=>o("span",null,"Detalles de la Orden",-1)),ve={class:"info-field"},xe=p(()=>o("div",{class:"text-caption text-primary"},"Número de Orden",-1)),be={class:"text-h6 font-weight-bold"},Ce={class:"info-field"},De=p(()=>o("div",{class:"text-caption text-primary"},"Fecha",-1)),ke={class:"text-h6 font-weight-bold"},Ve={class:"info-field"},Oe=p(()=>o("div",{class:"text-caption text-primary"},"Estado Actual",-1)),Se={class:"info-field"},we=p(()=>o("div",{class:"text-caption text-primary"},"Importe Total",-1)),Pe={class:"text-h6 font-weight-bold text-success"},Re={class:"info-field"},Te=p(()=>o("div",{class:"text-caption text-primary"},"Productos",-1)),Ee={class:"text-h6 font-weight-bold"},Fe=p(()=>o("small",{class:"text-caption"},"items",-1)),Me=p(()=>o("span",null,"Información del Cliente",-1)),Ae={class:"info-field"},Ne=p(()=>o("div",{class:"text-caption text-grey-darken-2"},"Nombre",-1)),Ie={class:"text-body-1 font-weight-bold"},Ue={class:"info-field"},Le=p(()=>o("div",{class:"text-caption text-grey-darken-2"},"Dirección",-1)),ze={class:"text-body-1 font-weight-bold"},Be={class:"info-field"},Ge=p(()=>o("div",{class:"text-caption text-grey-darken-2"},"Contacto",-1)),je={class:"text-body-1 font-weight-bold"},He=p(()=>o("br",null,null,-1)),Ye={class:"v-card-item"},qe={class:"v-card-item__content"},Je={class:"v-card-title"},Ke={class:"text-h5"};function Qe(s,r,i,u,a,n){const f=B,h=H("IconBtn"),_=G;return C(),V(x,null,{default:t(()=>[e(T,{class:"d-flex align-center"},{default:t(()=>[o("div",null,[le,o("div",re,[e(D,{icon:"ri-information-line",size:"16",class:"mr-1"}),oe])])]),_:1}),e(b,{class:"d-flex px-2"},{default:t(()=>[e(W,{headers:n.showHeaders,items:n.filteredStock,class:"text-no-wrap striped-table",loading:a.loading},{top:t(()=>[e(x,{flat:"",color:"white"},{default:t(()=>[e(b,null,{default:t(()=>[e(y,null,{default:t(()=>[e(m,{cols:"12",md:"3",sm:"3",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(X,{modelValue:a.search,"onUpdate:modelValue":r[0]||(r[0]=l=>a.search=l),label:"Número de Orden"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",md:"3",sm:"3",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(k,{modelValue:a.selectedCustomer,"onUpdate:modelValue":r[1]||(r[1]=l=>a.selectedCustomer=l),items:a.customers,"item-title":a.customers.firstname?"firstname":"address","item-value":"id",label:"Clientes",multiple:"",clearable:""},null,8,["modelValue","items","item-title"])]),_:1}),e(m,{cols:"12",md:"3",sm:"3",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(k,{modelValue:a.selectedPaymentStatus,"onUpdate:modelValue":r[2]||(r[2]=l=>a.selectedPaymentStatus=l),items:a.paymentStatuses,"item-title":"name","item-value":"id",label:"Estado del pago",clearable:""},null,8,["modelValue","items"])]),_:1}),e(m,{cols:"12",md:"3",sm:"3",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(k,{modelValue:a.selectedShipmentStatus,"onUpdate:modelValue":r[3]||(r[3]=l=>a.selectedShipmentStatus=l),items:a.shipmentStatuses,"item-title":"name","item-value":"id",label:"Estado del envio",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(m,{cols:"12",sm:"6",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(f,{ref:"dateOrderRange",modelValue:a.dateOrderRange,"onUpdate:modelValue":r[4]||(r[4]=l=>a.dateOrderRange=l),modelLabel:"Fecha Orden"},null,8,["modelValue"])]),_:1}),e(m,{cols:"12",sm:"6",class:"pl-0 pt-20 py-2"},{default:t(()=>[e(f,{ref:"dateDeliveryRange",modelValue:a.dateRange,"onUpdate:modelValue":r[5]||(r[5]=l=>a.dateRange=l),modelLabel:"Fecha Entrega"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),"item.order_number":t(({item:l})=>[o("div",ne,[o("div",ie,[o("span",de,c(l.order_number),1),o("small",null,"Cant: "+c(l.quantity_products),1)])])]),"item.customer.firstname":t(({item:l})=>[l.customer.firstname?(C(),A("span",ce,c(l.customer.firstname+" "+l.customer.lastname),1)):O("",!0)]),"item.order_date":t(({item:l})=>[o("div",me,[o("span",ue,c(n.formatDateGrid(l.order_date.split(" ")[0])),1),o("small",fe,c(l.order_date.split(" ")[1]||""),1)])]),"item.delivery_date":t(({item:l})=>[l.shipping&&l.delivery_date?(C(),V(y,{key:0,class:"d-flex align-center"},{default:t(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(S,{title:"con envio",icon:"ri-truck-line",class:"text-info mr-2",variant:"tonal",size:"40"})]),_:1}),e(m,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[o("strong",null,c(n.getDate(l.delivery_date)),1)]),_:2},1024)]),_:2},1024)):O("",!0)]),"item.total_cost":t(({item:l})=>[o("div",he,[o("strong",null,c(n.formatCurrency(l.total_cost)),1)])]),"item.total_profit":t(({item:l})=>[o("div",_e,[o("strong",null,c(n.formatCurrency(l.total_profit)),1)])]),"item.customer":t(({item:l})=>[o("strong",null,c(n.getCustomer(l.customer)),1)]),"item.total_amount":t(({item:l})=>[o("div",{class:Y(l.total_profit>0?"text-right text-success":"text-right text-error")},[o("strong",null,c(n.formatCurrency(l.total_amount)),1)],2)]),"item.payment_status_id":t(({item:l})=>[o("div",pe,[e(w,{color:n.getStatusCodeColor(l.payment_status.code),"prepend-icon":"ri-money-dollar-circle-line",density:"comfortable",class:"my-1"},{default:t(()=>[d(c(l.payment_status.name),1)]),_:2},1032,["color"]),e(w,{color:n.getStatusCodeColor(l.shipment_status.code),"prepend-icon":"ri-truck-line",density:"comfortable",class:"my-1"},{default:t(()=>[d(c(l.shipment_status.name),1)]),_:2},1032,["color"])])]),"item.actions":t(({item:l})=>[o("div",ge,[e($,{"offset-y":"",transition:"scale-transition"},{activator:t(({props:g})=>[e(h,N({size:"small"},g),{default:t(()=>[e(D,{icon:"ri-more-2-fill"})]),_:2},1040)]),default:t(()=>[e(ee,null,{default:t(()=>[e(P,{onClick:g=>n.showRemito(l)},{default:t(()=>[e(R,null,{default:t(()=>[e(h,{size:"small",class:"my-1",title:"Remito"},{default:t(()=>[e(D,{icon:"ri-file-pdf-2-line"})]),_:1}),d("Remito ")]),_:1})]),_:2},1032,["onClick"]),e(P,{onClick:g=>n.showRemitoComanda(l)},{default:t(()=>[e(R,null,{default:t(()=>[e(h,{size:"small",class:"my-1",title:"Comanda"},{default:t(()=>[e(D,{icon:"ri-file-pdf-2-line"})]),_:1}),d("Comanda ")]),_:1})]),_:2},1032,["onClick"]),e(P,{onClick:g=>n.openMovementDialog(l)},{default:t(()=>[e(R,null,{default:t(()=>[e(h,{size:"small",class:"my-1",title:"Cambiar el estado de la orden",onClick:g=>n.openMovementDialog(l)},{default:t(()=>[e(D,{icon:"ri-swap-box-line"})]),_:2},1032,["onClick"]),d("Estado ")]),_:2},1024)]),_:2},1032,["onClick"]),n.isPaid(l)?O("",!0):(C(),V(P,{key:0,onClick:g=>n.openPaymentForm(l)},{default:t(()=>[e(R,null,{default:t(()=>[e(h,{size:"small",class:"my-1",title:"Registrar Pago",onClick:g=>n.openPaymentForm(l)},{default:t(()=>[e(D,{icon:"ri-money-dollar-circle-line"})]),_:2},1032,["onClick"]),d("Registrar Pago ")]),_:2},1024)]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)])]),_:1},8,["headers","items","loading"]),e(L,{modelValue:a.movementDialog,"onUpdate:modelValue":r[9]||(r[9]=l=>a.movementDialog=l),"max-width":"80%"},{default:t(()=>[e(x,null,{default:t(()=>[e(I,{color:"primary"},{default:t(()=>[e(v,{icon:"ri-close-line",color:"white",onClick:n.closeMovementDialog},null,8,["onClick"]),e(U,null,{default:t(()=>[d(c(n.movementFormTitle),1)]),_:1}),e(F)]),_:1}),e(z,{ref:"movementForm",modelValue:a.validMovement,"onUpdate:modelValue":r[8]||(r[8]=l=>a.validMovement=l)},{default:t(()=>[e(b,null,{default:t(()=>[e(te,null,{default:t(()=>[e(x,{class:"mb-6",color:"primary-lighten-5"},{default:t(()=>[e(T,{class:"d-flex align-center"},{default:t(()=>[e(S,{icon:"ri-inbox-unarchive-line",class:"text-info mr-2",variant:"tonal"}),ye]),_:1}),e(M),e(b,null,{default:t(()=>[e(y,null,{default:t(()=>[e(m,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[o("div",ve,[xe,o("span",be,c(a.selectedOrder.order_number),1)])]),_:1}),e(m,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[o("div",Ce,[De,o("span",ke,c(a.selectedOrder.order_date),1)])]),_:1}),e(m,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[o("div",Ve,[Oe,e(w,{color:n.getStatusColor(a.selectedOrder),class:"font-weight-bold"},{default:t(()=>[d(c(a.selectedOrder.payment_status.name),1)]),_:1},8,["color"]),e(w,{color:n.getStatusColor(a.selectedOrder),class:"font-weight-bold"},{default:t(()=>[d(c(a.selectedOrder.shipment_status.name),1)]),_:1},8,["color"])])]),_:1}),e(m,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[o("div",Se,[we,o("span",Pe,c(n.formatCurrency(a.selectedOrder.total_amount)),1)])]),_:1}),e(m,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[o("div",Re,[Te,o("span",Ee,[d(c(a.selectedOrder.quantity_products)+" ",1),Fe])])]),_:1})]),_:1})]),_:1})]),_:1}),e(x,{class:"mb-6",color:"grey-lighten-4"},{default:t(()=>[e(T,{class:"d-flex align-center"},{default:t(()=>[e(S,{icon:"ri-user-line",class:"text-info mr-2",variant:"tonal"}),Me]),_:1}),e(M),e(b,null,{default:t(()=>[e(y,null,{default:t(()=>[e(m,{cols:"12",md:"4"},{default:t(()=>[o("div",Ae,[Ne,o("span",Ie,c(a.selectedOrder.customer.firstname)+" "+c(a.selectedOrder.customer.lastname),1)])]),_:1}),e(m,{cols:"12",md:"4"},{default:t(()=>[o("div",Ue,[Le,o("span",ze,c(a.selectedOrder.customer.address),1)])]),_:1}),e(m,{cols:"12",md:"4"},{default:t(()=>[o("div",Be,[Ge,o("span",je,[d(c(a.selectedOrder.customer.telephone||"Sin teléfono")+" ",1),a.selectedOrder.customer.email?(C(),A(q,{key:0},[He,d(c(a.selectedOrder.customer.email),1)],64)):O("",!0)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(m,{cols:"12",md:"6",sm:"6"},{default:t(()=>[e(k,{modelValue:a.movement.payment_status_id,"onUpdate:modelValue":r[6]||(r[6]=l=>a.movement.payment_status_id=l),items:a.paymentStatuses,"item-title":"name","item-value":"id",label:"Estado del pago",rules:[n.validateStatusChange(a.movement.payment_status_id,1)],variant:"outlined",class:"mt-2",clearable:""},null,8,["modelValue","items","rules"])]),_:1}),e(m,{cols:"12",md:"6",sm:"6"},{default:t(()=>[e(k,{modelValue:a.movement.shipment_status_id,"onUpdate:modelValue":r[7]||(r[7]=l=>a.movement.shipment_status_id=l),items:a.shipmentStatuses,"item-title":"name","item-value":"id",label:"Estado de la entrega",rules:[n.validateStatusChange(a.movement.shipment_status_id,2)],variant:"outlined",class:"mt-2",clearable:""},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(F),e(v,{variant:"outlined",color:"secondary",onClick:n.closeMovementDialog},{default:t(()=>[d(" Cancelar ")]),_:1},8,["onClick"]),e(v,{color:"white",class:"bg-primary",onClick:n.saveMovement,loading:a.savingMovement,disabled:!a.validMovement},{default:t(()=>[d(" Actualizar Estado ")]),_:1},8,["onClick","loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),e(L,{modelValue:a.paymentFormDialog,"onUpdate:modelValue":r[11]||(r[11]=l=>a.paymentFormDialog=l),"max-width":"1000px"},{default:t(()=>[e(x,null,{default:t(()=>[e(I,{color:"success"},{default:t(()=>[e(v,{icon:"ri-close-line",color:"white",onClick:n.closePaymentForm},null,8,["onClick"]),e(U,null,{default:t(()=>[d("Registrar Pago")]),_:1})]),_:1}),e(z,{ref:"paymentForm",modelValue:a.validPayment,"onUpdate:modelValue":r[10]||(r[10]=l=>a.validPayment=l)},{default:t(()=>[e(b,null,{default:t(()=>[e(y,{class:"justify-center"},{default:t(()=>[e(m,{cols:"12",md:"12",sm:"12"},{default:t(()=>[e(x,null,{default:t(()=>[o("div",Ye,[o("div",qe,[o("div",Je,[o("h5",Ke,[e(S,{icon:"ri-money-dollar-circle-line",class:"text-success mr-2",variant:"tonal"}),d("Pagos ")])])])]),e(b,null,{default:t(()=>[e(y,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(se,{type:"success",variant:"tonal",class:"mb-4",icon:!1},{default:t(()=>[e(y,null,{default:t(()=>[e(m,{cols:"12",sm:"9",class:"text-end text-h5 text-success"},{default:t(()=>[d(" Total de la Orden: ")]),_:1}),e(m,{cols:"12",sm:"3",class:"text-end text-h5 text-success"},{default:t(()=>{var l,g;return[d(c(n.formatCurrency((g=(l=a.createdOrder)==null?void 0:l.order)==null?void 0:g.total_amount)),1)]}),_:1})]),_:1}),e(y,null,{default:t(()=>[e(m,{cols:"12",sm:"9",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(" Total Pagado: ")]),_:1}),e(m,{cols:"12",sm:"3",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(c(n.formatCurrency(a.totalPaid)),1)]),_:1})]),_:1}),e(y,{class:"pb-2"},{default:t(()=>[e(m,{cols:"12",sm:"9",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(" Saldo Pendiente: ")]),_:1}),e(m,{cols:"12",sm:"3",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(c(n.formatCurrency(n.pendingAmount)),1)]),_:1})]),_:1}),e(M,{thickness:3,color:"success"}),e(y,{class:"pt-4"},{default:t(()=>[e(m,{cols:"12",sm:"9",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(" Vuelto: ")]),_:1}),e(m,{cols:"12",sm:"3",class:"text-end pt-0 text-h5 text-success"},{default:t(()=>[d(c(n.formatCurrency(a.change)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(C(),V(_,{ref:"paymentsRow",key:a.keyPayments,modulo:"pagos",onUpdateTotal:n.updateTotal},null,8,["onUpdateTotal"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(F),e(v,{variant:"outlined",color:"success",onClick:n.closePaymentForm},{default:t(()=>[d(" Cancelar ")]),_:1},8,["onClick"]),e(v,{class:"bg-success",color:"white",onClick:n.savePayment,loading:a.savingPayment},{default:t(()=>[d(" Registrar Pago ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:a.snackbar,"onUpdate:modelValue":r[13]||(r[13]=l=>a.snackbar=l),color:a.snackbarColor,timeout:3e3},{action:t(({attrs:l})=>[e(v,N({text:""},l,{onClick:r[12]||(r[12]=g=>a.snackbar=!1)}),{default:t(()=>[d(" Cerrar ")]),_:2},1040)]),default:t(()=>[d(c(a.snackbarText)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}),e(E,{class:"justify-end custom-actions"},{default:t(()=>[e(v,{variant:"outlined",color:"success",onClick:r[14]||(r[14]=l=>n.getDeliveryReport(1))},{default:t(()=>[d(" Reporte de Entregas ")]),_:1}),e(v,{variant:"outlined",color:"warning",onClick:r[15]||(r[15]=l=>n.getDeliveryReport(2))},{default:t(()=>[d(" Reporte de Entregas Cliente ")]),_:1})]),_:1})]),_:1})}const Ct=Q(ae,[["render",Qe],["__scopeId","data-v-69a0768e"]]);export{Ct as default};
