import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as p,V as h,d as M}from"./VCard-BQxw42q_.js";import{V as E}from"./VDataTable-BZeOkjMV.js";import{a as g,V as i}from"./VRow-DH7aR9kf.js";import{V as k}from"./VTextField-C2daNm2f.js";import{a as V,b as w,c as b,V as N}from"./VSnackbar-nnY25wgc.js";import{V as H}from"./filter-Bl3bQea1.js";import{e as S,w as o,v as A,o as _,b as e,a3 as c,V as x,H as u,c as U,t as m,a as f,l as D,a9 as B,n as L,a0 as W,x as G,y as O}from"./main-G7GggmvP.js";import{e as q}from"./VChip-CjnngcFM.js";import{V as C}from"./VDialog-BHz1YP4b.js";import{V as y}from"./VSpacer-BvA2ByrV.js";import{V as I}from"./VForm-Bd0OU5H5.js";import{V as R}from"./VContainer-D4ThSbng.js";import{V as j}from"./VAlert-mYeo-nKw.js";import"./VAvatar-B02VXU15.js";import"./VImg-Ch7KTabo.js";import"./VCheckboxBtn-CCJ6usBb.js";import"./VTable-zLaNu0tT.js";import"./VDivider-BWJONb8H.js";import"./index-Dxz9A6E-.js";import"./easing-DY7PVvcf.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-C0oUUi6-.js";import"./lazy-BCldeQdb.js";import"./ssrBoot-BEVycVPs.js";const Q={data(){return{loading:!1,search:"",stock:[],products:[],warehouses:[],selectedProduct:null,selectedWarehouse:null,selectedStockItem:null,stockFilter:null,movementDialog:!1,transferDialog:!1,reserveDialog:!1,historyDialog:!1,summaryDialog:!1,validMovement:!1,validTransfer:!1,validReserve:!1,savingMovement:!1,savingTransfer:!1,savingReserve:!1,movement:{product_id:null,warehouse_id:null,movement_type:"entrada",quantity:1,minimum_stock:0,maximum_stock:0,notes:""},transfer:{product_id:null,from_warehouse_id:null,to_warehouse_id:null,quantity:1,notes:""},reserve:{quantity:1},movementTypes:[{text:"Entrada",value:"entrada"},{text:"Salida",value:"salida"},{text:"Fraccionado",value:"fraccionado"},{text:"Ajuste",value:"ajuste"},{text:"Transferencia",value:"transferencia"}],stockFilterOptions:[{title:"Todos",value:null},{title:"Stock Bajo",value:"low"},{title:"Sin Stock",value:"empty"}],movementHistory:[],stockSummary:{total_products:0,total_stock_value:0,low_stock_count:0,out_of_stock_count:0},snackbar:!1,snackbarText:"",snackbarColor:"success",headers:[{title:"Acciones",key:"actions",sortable:!1,width:"100px"},{title:"Codigo",key:"product.code",width:"50px"},{title:"Producto",key:"product.name",width:"250px"},{title:"Stock",key:"quantity",width:"50px"},{title:"Mín",key:"minimum_stock",width:"80px"}],historyHeaders:[{title:"Fecha",key:"created_at"},{title:"Tipo",key:"movement_type"},{title:"Cantidad",key:"quantity"},{title:"Stock anterior",key:"previous_quantity"},{title:"Stock nuevo",key:"new_quantity"},{title:"Usuario",key:"user.name"},{title:"Notas",key:"notes"}]}},computed:{showHeaders(){return this.headers},filteredStock(){let r=this.stock;return this.selectedProduct&&(r=r.filter(l=>{var n;return((n=l.product)==null?void 0:n.id)===this.selectedProduct})),this.selectedWarehouse&&(r=r.filter(l=>{var n;return((n=l.warehouse)==null?void 0:n.id)===this.selectedWarehouse})),this.stockFilter==="low"?r=r.filter(l=>l.available<l.minimum_stock):this.stockFilter==="empty"&&(r=r.filter(l=>l.quantity<=0)),r},movementFormTitle(){return this.selectedStockItem?`Registrar movimiento para ${this.selectedStockItem.product.name}`:"Registrar movimiento de stock"},quantityRules(){const r=[l=>!!l||"Cantidad es requerida",l=>l>0||"Debe ser mayor a 0"];return this.movement.movement_type==="salida"&&this.selectedStockItem&&r.push(l=>l<=this.selectedStockItem.available||"Stock insuficiente"),r}},async created(){await this.fetchData()},methods:{productTitle(r){const l=this.$store.getters.currentUser;let n=r.name;return r.display_price||r.sale_price,l.data.tenant.id==2&&(n=`[${r.code}] ${r.name} `),l.data.tenant.id==3&&(n=`${r.name} [${r.code}]`),`${n}`},async loadProducts(){try{const r=await this.$axios.get(this.$routes.products);this.products=r.data.data}catch(r){console.error("Error cargando categorías:",r)}finally{}},async fetchData(){this.loading=!0;try{const[r,l,n]=await Promise.all([this.$axios.get(this.$routes.stocks),this.$axios.get(this.$routes.products),this.$axios.get(this.$routes.warehouses)]);this.stock=r.data.data,this.stock=r.data.data.map(d=>({...d,available:d.quantity-d.reserved_quantity})),this.products=l.data.data,this.warehouses=n.data.data}catch(r){console.error("Error fetching data:",r),this.showSnackbar("Error al cargar los datos","error")}finally{this.loading=!1}},openMovementDialog(r){if(r)this.selectedStockItem=r,this.movement.product_id=r.product.id,this.movement.warehouse_id=r.warehouse?r.warehouse.id:null;else{this.selectedStockItem=null,this.movement.product_id=null;let n=this.$store.getters.currentUser.data.tenant.id;this.movement.warehouse_id=n}console.log(this.movement),this.movementDialog=!0},closeMovementDialog(){var r;this.movementDialog=!1,(r=this.$refs.movementForm)==null||r.reset(),this.selectedStockItem=null,this.movement={product_id:null,warehouse_id:null,movement_type:"entrada",quantity:1,minimum_stock:0,maximum_stock:0,notes:""}},async saveMovement(){var l,n;if(await this.$refs.movementForm.validate()){this.savingMovement=!0;try{let d,s;this.selectedStockItem?(d=`${this.$routes.stocks}/${this.selectedStockItem.id}/movements`,s={movement_type:this.movement.movement_type,quantity:this.movement.movement_type==="salida"?-Math.abs(this.movement.quantity):Math.abs(this.movement.quantity),notes:this.movement.notes}):(d=`${this.$routes.stocks}/create-or-update`,s={product_id:this.movement.product_id,warehouse_id:this.movement.warehouse_id,quantity:this.movement.quantity,minimum_stock:this.movement.minimum_stock,maximum_stock:this.movement.maximum_stock,movement_type:this.movement.movement_type}),await this.$axios.post(d,s),this.showSnackbar("Movimiento registrado correctamente","success"),this.closeMovementDialog(),await this.fetchData()}catch(d){console.error("Error saving movement:",d),this.showSnackbar(((n=(l=d.response)==null?void 0:l.data)==null?void 0:n.message)||"Error al registrar el movimiento","error")}finally{this.savingMovement=!1}}},openTransferDialog(){this.transferDialog=!0},closeTransferDialog(){var r;this.transferDialog=!1,(r=this.$refs.transferForm)==null||r.reset(),this.transfer={product_id:null,from_warehouse_id:null,to_warehouse_id:null,quantity:1,notes:""}},async saveTransfer(){var l,n;if(await this.$refs.transferForm.validate()){this.savingTransfer=!0;try{await this.$axios.post(`${this.$routes.stocks}/transfer`,this.transfer),this.showSnackbar("Transferencia realizada correctamente","success"),this.closeTransferDialog(),await this.fetchData()}catch(d){console.error("Error saving transfer:",d),this.showSnackbar(((n=(l=d.response)==null?void 0:l.data)==null?void 0:n.message)||"Error al realizar la transferencia","error")}finally{this.savingTransfer=!1}}},openReserveDialog(r){console.log(r),this.selectedStockItem=r,this.reserveDialog=!0},closeReserveDialog(){var r;this.reserveDialog=!1,(r=this.$refs.reserveForm)==null||r.reset(),this.selectedStockItem=null,this.reserve={quantity:1}},async saveReserve(){var l,n;if(await this.$refs.reserveForm.validate()){this.savingReserve=!0;try{await this.$axios.post(`${this.$routes.stocks}/${this.selectedStockItem.id}/reserve`,this.reserve),this.showSnackbar("Stock reservado correctamente","success"),this.closeReserveDialog(),await this.fetchData()}catch(d){console.error("Error reserving stock:",d),this.showSnackbar(((n=(l=d.response)==null?void 0:l.data)==null?void 0:n.message)||"Error al reservar el stock","error")}finally{this.savingReserve=!1}}},async showHistory(r){try{const l=await this.$axios.get(`${this.$routes.stocks}/${r.id}/movements?include=user`);this.movementHistory=l.data.data,this.historyDialog=!0}catch(l){console.error("Error fetching history:",l),this.showSnackbar("Error al cargar el historial","error")}},async showSummary(){try{const r=await this.$axios.get(`${this.$routes.stocks}/summary`);this.stockSummary=r.data.data,this.summaryDialog=!0}catch(r){console.error("Error fetching summary:",r),this.showSnackbar("Error al cargar el resumen","error")}},getStockLevelColor(r){return r.minimum_stock?r.available<=0?"error":r.available<r.minimum_stock?"warning":"success":"primary"},calculateStockPercentage(r){return!r.maximum_stock||r.maximum_stock<=0?0:r.quantity/r.maximum_stock*100},calculateStockPercentageMin(r){return!r.minimum_stock||r.minimum_stock<=0?0:r.quantity/r.minimum_stock*100},formatMovementType(r){return{entrada:"Entrada",salida:"Salida",ajuste:"Ajuste",transferencia:"Transferencia",fraccionado:"Fraccionado"}[r]||r},getMovementTypeColor(r){return{entrada:"success",salida:"error",fraccionado:"error",ajuste:"warning",transferencia:"info"}[r]||"primary"},getQuantityClass(r){return["entrada","ajuste"].includes(r)?"text-success":"text-error"},formatDate(r){return new Date(r).toLocaleString()},formatCurrency(r){return r?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(r):"$0"},showSnackbar(r,l){this.snackbarText=r,this.snackbarColor=l,this.snackbar=!0}}},T=r=>(G("data-v-a3b757b3"),r=r(),O(),r),J={key:0},K={key:1,class:"text-disabled"},X={class:"d-flex align-center gap-2"},Y={key:0,class:"text-caption"},Z={class:"d-flex flex-wrap gap-1 align-center",style:{"min-width":"80px"}},$=T(()=>f("br",null,null,-1)),ee={class:"text-h4"},te=T(()=>f("div",{class:"text-caption"},"Productos",-1)),oe={class:"text-h4"},le=T(()=>f("div",{class:"text-caption"},"Valor Total",-1)),se={class:"text-h4"},re=T(()=>f("div",{class:"text-caption"},"Stock Bajo",-1)),ae={class:"text-h4"},ie=T(()=>f("div",{class:"text-caption"},"Sin Stock",-1));function ne(r,l,n,d,s,a){const F=A("IconBtn");return _(),S(p,{title:"Gestión de Stock"},{default:o(()=>[e(h,{class:"d-flex px-2"},{default:o(()=>[e(E,{headers:a.showHeaders,items:a.filteredStock,search:s.search,class:"text-no-wrap striped-table",loading:s.loading},{top:o(()=>[e(p,{flat:"",color:"white"},{default:o(()=>[e(h,null,{default:o(()=>[e(g,null,{default:o(()=>[e(i,{cols:"12",sm:"6",class:"pl-0 pt-20 py-2"},{default:o(()=>[e(k,{modelValue:s.search,"onUpdate:modelValue":l[0]||(l[0]=t=>s.search=t),label:"Buscar en stock"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",sm:"3",class:"pt-20 py-2"},{default:o(()=>[e(V,{modelValue:s.selectedWarehouse,"onUpdate:modelValue":l[1]||(l[1]=t=>s.selectedWarehouse=t),items:s.warehouses,"item-title":"name","item-value":"id",label:"Depósito",clearable:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",sm:"3",class:"pt-20 py-2"},{default:o(()=>[e(H,{modelValue:s.stockFilter,"onUpdate:modelValue":l[2]||(l[2]=t=>s.stockFilter=t),items:s.stockFilterOptions,label:"Filtrar stock",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(g,null,{default:o(()=>[e(i,{cols:"12",sm:"6",class:"pl-0 pt-20 py-2"},{default:o(()=>[e(V,{modelValue:s.selectedProduct,"onUpdate:modelValue":l[3]||(l[3]=t=>s.selectedProduct=t),items:s.products,"item-title":a.productTitle,"item-value":"id",label:"Producto",clearable:""},null,8,["modelValue","items","item-title"])]),_:1}),e(i,{cols:"12",sm:"6",class:"pt-20 py-2 d-flex gap-2"},{default:o(()=>[e(c,{color:"primary",size:"large",title:"Registrar movimiento",onClick:l[4]||(l[4]=t=>a.openMovementDialog(null))},{default:o(()=>[e(x,{icon:"ri-add-circle-line",class:"mr-1"}),u(" Movimiento ")]),_:1}),e(c,{color:"secondary",size:"large",title:"Transferir stock",onClick:l[5]||(l[5]=t=>a.openTransferDialog())},{default:o(()=>[e(x,{icon:"ri-arrow-left-right-line",class:"mr-1"}),u(" Transferir ")]),_:1}),e(c,{color:"info",size:"large",title:"Ver resumen",onClick:l[6]||(l[6]=t=>a.showSummary())},{default:o(()=>[e(x,{icon:"ri-pie-chart-line"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"item.warehouse.name":o(({item:t})=>[t.warehouse?(_(),U("span",J,m(t.warehouse.name),1)):(_(),U("span",K,"Sin depósito"))]),"item.quantity":o(({item:t})=>[f("div",X,[e(q,{color:a.getStockLevelColor(t),density:"comfortable"},{default:o(()=>[u(m(t.quantity),1)]),_:2},1032,["color"]),t.reserved_quantity>0?(_(),U("span",Y," (Reservado: "+m(t.reserved_quantity)+") ",1)):D("",!0),t.available<t.minimum_stock?(_(),S(q,{key:1,color:"error",size:"small",variant:"outlined"},{default:o(()=>[u(" Stock Bajo ")]),_:1})):D("",!0)])]),"item.available":o(({item:t})=>[e(q,{color:t.available>0?"success":"error",density:"comfortable"},{default:o(()=>[u(m(t.available),1)]),_:2},1032,["color"])]),"item.stock_level_min":o(({item:t})=>[e(B,{"model-value":a.calculateStockPercentageMin(t),color:a.getStockLevelColor(t),height:"20",rounded:""},{default:o(({value:v})=>[f("strong",null,m(Math.ceil(v))+"%",1)]),_:2},1032,["model-value","color"])]),"item.stock_level":o(({item:t})=>[e(B,{"model-value":a.calculateStockPercentage(t),color:a.getStockLevelColor(t),height:"20",rounded:""},{default:o(({value:v})=>[f("strong",null,m(Math.ceil(v))+"%",1)]),_:2},1032,["model-value","color"])]),"item.actions":o(({item:t})=>[f("div",Z,[e(F,{size:"small",class:"my-1",title:"Registrar movimiento",onClick:v=>a.openMovementDialog(t)},{default:o(()=>[e(x,{icon:"ri-arrow-up-down-line"})]),_:2},1032,["onClick"]),e(F,{size:"small",class:"my-1",title:"Ver historial",onClick:v=>a.showHistory(t)},{default:o(()=>[e(x,{icon:"ri-history-line"})]),_:2},1032,["onClick"])])]),_:1},8,["headers","items","search","loading"]),e(C,{modelValue:s.movementDialog,"onUpdate:modelValue":l[15]||(l[15]=t=>s.movementDialog=t),"max-width":"700px"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,{color:"primary"},{default:o(()=>[e(c,{icon:"ri-close-line",color:"white",onClick:a.closeMovementDialog},null,8,["onClick"]),e(b,null,{default:o(()=>[u(m(a.movementFormTitle),1)]),_:1}),e(y)]),_:1}),e(I,{ref:"movementForm",modelValue:s.validMovement,"onUpdate:modelValue":l[14]||(l[14]=t=>s.validMovement=t)},{default:o(()=>[e(h,null,{default:o(()=>[e(R,null,{default:o(()=>[e(g,null,{default:o(()=>[e(i,{cols:"12",sm:"12"},{default:o(()=>[e(V,{modelValue:s.movement.product_id,"onUpdate:modelValue":l[7]||(l[7]=t=>s.movement.product_id=t),items:s.products,"item-title":a.productTitle,"item-value":"id",label:"Producto",rules:[t=>!!t||"Producto es requerido"],disabled:!!s.selectedStockItem},null,8,["modelValue","items","item-title","rules","disabled"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:o(()=>[e(V,{modelValue:s.movement.warehouse_id,"onUpdate:modelValue":l[8]||(l[8]=t=>s.movement.warehouse_id=t),items:s.warehouses,"item-title":"name","item-value":"id",label:"Depósito",rules:[t=>!!t||"Depósito es requerido"],disabled:!!s.selectedStockItem},null,8,["modelValue","items","rules","disabled"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:o(()=>[e(H,{modelValue:s.movement.movement_type,"onUpdate:modelValue":l[9]||(l[9]=t=>s.movement.movement_type=t),items:s.movementTypes,"item-title":"text","item-value":"value",label:"Tipo de movimiento",rules:[t=>!!t||"Tipo es requerido"]},null,8,["modelValue","items","rules"])]),_:1}),e(i,{cols:"12",sm:"4"},{default:o(()=>[e(k,{modelValue:s.movement.quantity,"onUpdate:modelValue":l[10]||(l[10]=t=>s.movement.quantity=t),label:"Cantidad",type:"number",step:"1",rules:a.quantityRules},null,8,["modelValue","rules"])]),_:1}),s.selectedStockItem?D("",!0):(_(),S(i,{key:0,cols:"12",sm:"4"},{default:o(()=>[e(k,{modelValue:s.movement.minimum_stock,"onUpdate:modelValue":l[11]||(l[11]=t=>s.movement.minimum_stock=t),label:"Stock Mínimo",type:"number",step:"1",hint:"Solo para productos nuevos"},null,8,["modelValue"])]),_:1})),s.selectedStockItem?D("",!0):(_(),S(i,{key:1,cols:"12",sm:"4"},{default:o(()=>[e(k,{modelValue:s.movement.maximum_stock,"onUpdate:modelValue":l[12]||(l[12]=t=>s.movement.maximum_stock=t),label:"Stock Máximo",type:"number",step:"1",hint:"Solo para productos nuevos"},null,8,["modelValue"])]),_:1})),e(i,{cols:"12"},{default:o(()=>[e(k,{modelValue:s.movement.notes,"onUpdate:modelValue":l[13]||(l[13]=t=>s.movement.notes=t),label:"Notas",placeholder:"Motivo del movimiento"},null,8,["modelValue"])]),_:1}),s.movement.movement_type==="salida"&&s.selectedStockItem?(_(),S(i,{key:2,cols:"12"},{default:o(()=>[e(j,{type:"info",variant:"tonal"},{default:o(()=>[u(" Stock disponible: "+m(s.selectedStockItem.available),1)]),_:1})]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(y),e(c,{variant:"outlined",color:"primary",onClick:a.closeMovementDialog},{default:o(()=>[u(" Cancelar ")]),_:1},8,["onClick"]),e(c,{class:"bg-primary",color:"white",onClick:a.saveMovement,loading:s.savingMovement},{default:o(()=>[u(" Guardar movimiento ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.transferDialog,"onUpdate:modelValue":l[22]||(l[22]=t=>s.transferDialog=t),"max-width":"1100px"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,{color:"secondary"},{default:o(()=>[e(c,{icon:"ri-close-line",color:"white",onClick:a.closeTransferDialog},null,8,["onClick"]),e(b,null,{default:o(()=>[u("Transferir Stock")]),_:1}),e(y)]),_:1}),e(I,{ref:"transferForm",modelValue:s.validTransfer,"onUpdate:modelValue":l[21]||(l[21]=t=>s.validTransfer=t)},{default:o(()=>[e(h,null,{default:o(()=>[e(R,null,{default:o(()=>[e(g,null,{default:o(()=>[e(i,{cols:"12"},{default:o(()=>[e(V,{modelValue:s.transfer.product_id,"onUpdate:modelValue":l[16]||(l[16]=t=>s.transfer.product_id=t),items:s.products,"item-title":a.productTitle,"item-value":"id",label:"Producto",rules:[t=>!!t||"Producto es requerido"]},null,8,["modelValue","items","item-title","rules"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:o(()=>[e(V,{modelValue:s.transfer.from_warehouse_id,"onUpdate:modelValue":l[17]||(l[17]=t=>s.transfer.from_warehouse_id=t),items:s.warehouses,"item-title":"name","item-value":"id",label:"Desde depósito",rules:[t=>!!t||"Depósito origen es requerido"]},null,8,["modelValue","items","rules"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:o(()=>[e(V,{modelValue:s.transfer.to_warehouse_id,"onUpdate:modelValue":l[18]||(l[18]=t=>s.transfer.to_warehouse_id=t),items:s.warehouses,"item-title":"name","item-value":"id",label:"Hacia depósito",rules:[t=>!!t||"Depósito destino es requerido",t=>t!==s.transfer.from_warehouse_id||"Debe ser diferente al origen"]},null,8,["modelValue","items","rules"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:o(()=>[e(k,{modelValue:s.transfer.quantity,"onUpdate:modelValue":l[19]||(l[19]=t=>s.transfer.quantity=t),label:"Cantidad",type:"number",step:"1",rules:[t=>!!t||"Cantidad es requerida",t=>t>0||"Debe ser mayor a 0"]},null,8,["modelValue","rules"])]),_:1}),e(i,{cols:"12"},{default:o(()=>[e(k,{modelValue:s.transfer.notes,"onUpdate:modelValue":l[20]||(l[20]=t=>s.transfer.notes=t),label:"Notas",placeholder:"Motivo de la transferencia"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(y),e(c,{variant:"outlined",color:"secondary",onClick:a.closeTransferDialog},{default:o(()=>[u(" Cancelar ")]),_:1},8,["onClick"]),e(c,{class:"bg-secondary",color:"white",onClick:a.saveTransfer,loading:s.savingTransfer},{default:o(()=>[u(" Transferir ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.reserveDialog,"onUpdate:modelValue":l[25]||(l[25]=t=>s.reserveDialog=t),"max-width":"500px"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,{color:"info"},{default:o(()=>[e(c,{icon:"ri-close-line",color:"white",onClick:a.closeReserveDialog},null,8,["onClick"]),e(b,null,{default:o(()=>[u("Reservar Stock")]),_:1}),e(y)]),_:1}),e(I,{ref:"reserveForm",modelValue:s.validReserve,"onUpdate:modelValue":l[24]||(l[24]=t=>s.validReserve=t)},{default:o(()=>[e(h,null,{default:o(()=>[e(R,null,{default:o(()=>[e(g,null,{default:o(()=>[e(i,{cols:"12"},{default:o(()=>[e(j,{type:"info",variant:"tonal"},{default:o(()=>{var t,v,P;return[u(" Producto: "+m((v=(t=s.selectedStockItem)==null?void 0:t.product)==null?void 0:v.name),1),$,u(" Stock disponible: "+m((P=s.selectedStockItem)==null?void 0:P.available),1)]}),_:1})]),_:1}),e(i,{cols:"12"},{default:o(()=>[e(k,{modelValue:s.reserve.quantity,"onUpdate:modelValue":l[23]||(l[23]=t=>s.reserve.quantity=t),label:"Cantidad a reservar",type:"number",step:"1",rules:[t=>!!t||"Cantidad es requerida",t=>t>0||"Debe ser mayor a 0",t=>{var v;return t<=((v=s.selectedStockItem)==null?void 0:v.available)||"No hay suficiente stock disponible"}]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(y),e(c,{variant:"outlined",color:"info",onClick:a.closeReserveDialog},{default:o(()=>[u(" Cancelar ")]),_:1},8,["onClick"]),e(c,{class:"bg-info",color:"white",onClick:a.saveReserve,loading:s.savingReserve},{default:o(()=>[u(" Reservar ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.historyDialog,"onUpdate:modelValue":l[27]||(l[27]=t=>s.historyDialog=t),"max-width":"1100px"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,{color:"primary"},{default:o(()=>[e(c,{icon:"ri-close-line",color:"white",onClick:l[26]||(l[26]=t=>s.historyDialog=!1)}),e(b,null,{default:o(()=>[u("Historial de movimientos")]),_:1}),e(y)]),_:1}),e(h,null,{default:o(()=>[e(E,{headers:s.historyHeaders,items:s.movementHistory,"items-per-page":10},{"item.movement_type":o(({item:t})=>[e(q,{color:a.getMovementTypeColor(t.movement_type)},{default:o(()=>[u(m(a.formatMovementType(t.movement_type)),1)]),_:2},1032,["color"])]),"item.quantity":o(({item:t})=>[f("span",{class:L(a.getQuantityClass(t.movement_type))},m(t.quantity>0?"+":"")+m(t.quantity),3)]),"item.created_at":o(({item:t})=>[u(m(a.formatDate(t.created_at)),1)]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:s.summaryDialog,"onUpdate:modelValue":l[29]||(l[29]=t=>s.summaryDialog=t),"max-width":"800px"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,{color:"info"},{default:o(()=>[e(c,{icon:"ri-close-line",color:"white",onClick:l[28]||(l[28]=t=>s.summaryDialog=!1)}),e(b,null,{default:o(()=>[u("Resumen de Stock")]),_:1}),e(y)]),_:1}),e(h,null,{default:o(()=>[e(g,{class:"pt-6"},{default:o(()=>[e(i,{cols:"12",sm:"6",md:"6"},{default:o(()=>[e(p,{color:"primary",variant:"tonal"},{default:o(()=>[e(h,{class:"text-center"},{default:o(()=>[f("div",ee,m(s.stockSummary.total_products),1),te]),_:1})]),_:1})]),_:1}),e(i,{cols:"12",sm:"6",md:"6"},{default:o(()=>[e(p,{color:"success",variant:"tonal"},{default:o(()=>[e(h,{class:"text-center"},{default:o(()=>[f("div",oe,"$"+m(a.formatCurrency(s.stockSummary.total_stock_value)),1),le]),_:1})]),_:1})]),_:1})]),_:1}),e(g,null,{default:o(()=>[e(i,{cols:"12",sm:"6",md:"6"},{default:o(()=>[e(p,{color:"warning",variant:"tonal"},{default:o(()=>[e(h,{class:"text-center"},{default:o(()=>[f("div",se,m(s.stockSummary.low_stock_count),1),re]),_:1})]),_:1})]),_:1}),e(i,{cols:"12",sm:"6",md:"6"},{default:o(()=>[e(p,{color:"error",variant:"tonal"},{default:o(()=>[e(h,{class:"text-center"},{default:o(()=>[f("div",ae,m(s.stockSummary.out_of_stock_count),1),ie]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:s.snackbar,"onUpdate:modelValue":l[31]||(l[31]=t=>s.snackbar=t),color:s.snackbarColor,timeout:3e3},{action:o(({attrs:t})=>[e(c,W({text:""},t,{onClick:l[30]||(l[30]=v=>s.snackbar=!1)}),{default:o(()=>[u(" Cerrar ")]),_:2},1040)]),default:o(()=>[u(m(s.snackbarText)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})]),_:1})}const Fe=z(Q,[["render",ne],["__scopeId","data-v-a3b757b3"]]);export{Fe as default};
