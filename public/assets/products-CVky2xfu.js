import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as N,V as T,d as ge}from"./VCard-C4ovO3Xn.js";import{V as ve}from"./VDataTable-BLZgC8uG.js";import{a as F,V as s}from"./VRow-1IsH-HXB.js";import{m as Ve,a as he,u as ye,V as Z,f as Ie,b as be,c as Ce,d as P}from"./VTextField-DkY_PXxT.js";import{a as H,b as ke,c as we,V as Fe}from"./VSnackbar-DYX9Ldxv.js";import{e as j}from"./VChip-Dk80kfPr.js";import{V as Pe}from"./VDialog-D0HQfBvj.js";import{K as $e,av as Be,R as Se,U as Ue,al as Re,j as V,aw as x,r as D,s as ze,Y as Ae,an as Ne,b as t,a0 as $,F as L,a8 as Te,aq as He,v as De,o as c,e as y,w as l,a as E,t as g,l as I,c as S,a3 as b,V as U,H as h}from"./main-6un_LZV3.js";import{V as Le}from"./VForm-BroPHNre.js";import{V as Ee}from"./VContainer-C0DfHo0K.js";import{f as Me}from"./forwardRefs-C-GTDzx5.js";import{V as M}from"./VImg-DVuj2CJR.js";import{V as je}from"./VSpacer-pNpvz9cS.js";import{V as qe}from"./VSwitch-AwbuqzRS.js";import"./VAvatar-GilCUASU.js";import"./VOverlay-D_por6rs.js";import"./easing-DY7PVvcf.js";import"./lazy-7v_vxMTA.js";import"./VCheckboxBtn-B7YgUxzS.js";import"./VTable-CLNiyE_V.js";import"./VDivider-CbpsEDfw.js";import"./index-yGNNQEqj.js";import"./ssrBoot-IhPJnLOu.js";const _e=$e({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...Ve({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Be(e).every(i=>i!=null&&typeof i=="object")},...he({clearable:!0})},"VFileInput"),Oe=Se()({name:"VFileInput",inheritAttrs:!1,props:_e(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,i){let{attrs:f,emit:R,slots:u}=i;const{t:d}=Ue(),o=Re(e,"modelValue"),{isFocused:a,focus:m,blur:ee}=ye(e),q=V(()=>typeof e.showSize!="boolean"?e.showSize:void 0),_=V(()=>(o.value??[]).reduce((r,n)=>{let{size:C=0}=n;return r+C},0)),O=V(()=>x(_.value,q.value)),z=V(()=>(o.value??[]).map(r=>{const{name:n="",size:C=0}=r;return e.showSize?`${n} (${x(C,q.value)})`:n})),te=V(()=>{var n;const r=((n=o.value)==null?void 0:n.length)??0;return e.showSize?d(e.counterSizeString,r,O.value):d(e.counterString,r)}),G=D(),K=D(),v=D(),ae=V(()=>a.value||e.active),W=V(()=>["plain","underlined"].includes(e.variant));function A(){var r;v.value!==document.activeElement&&((r=v.value)==null||r.focus()),a.value||m()}function le(r){Y(r)}function ie(r){R("mousedown:control",r)}function Y(r){var n;(n=v.value)==null||n.click(),R("click:control",r)}function re(r){r.stopPropagation(),A(),Te(()=>{o.value=[],He(e["onClick:clear"],r)})}return ze(o,r=>{(!Array.isArray(r)||!r.length)&&v.value&&(v.value.value="")}),Ae(()=>{const r=!!(u.counter||e.counter),n=!!(r||u.details),[C,se]=Ne(f),{modelValue:xe,...oe}=Z.filterProps(e),ne=Ie(e);return t(Z,$({ref:G,modelValue:o.value,"onUpdate:modelValue":k=>o.value=k,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":W.value},e.class],style:e.style,"onClick:prepend":le},C,oe,{centerAffix:!W.value,focused:a.value}),{...u,default:k=>{let{id:B,isDisabled:w,isDirty:J,isReadonly:Q,isValid:de}=k;return t(be,$({ref:K,"prepend-icon":e.prependIcon,onMousedown:ie,onClick:Y,"onClick:clear":re,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},ne,{id:B.value,active:ae.value||J.value,dirty:J.value,disabled:w.value,focused:a.value,error:de.value===!1}),{...u,default:ue=>{var X;let{props:{class:me,...ce}}=ue;return t(L,null,[t("input",$({ref:v,type:"file",readonly:Q.value,disabled:w.value,multiple:e.multiple,name:e.name,onClick:p=>{p.stopPropagation(),Q.value&&p.preventDefault(),A()},onChange:p=>{if(!p.target)return;const fe=p.target;o.value=[...fe.files??[]]},onFocus:A,onBlur:ee},ce,se),null),t("div",{class:me},[!!((X=o.value)!=null&&X.length)&&(u.selection?u.selection({fileNames:z.value,totalBytes:_.value,totalBytesReadable:O.value}):e.chips?z.value.map(p=>t(j,{key:p,size:"small",color:e.color},{default:()=>[p]})):z.value.join(", "))])])}})},details:n?k=>{var B,w;return t(L,null,[(B=u.details)==null?void 0:B.call(u,k),r&&t(L,null,[t("span",null,null),t(Ce,{active:!!((w=o.value)!=null&&w.length),value:te.value},u.counter)])])}:void 0})}),Me({},G,K,v)}}),Ge={data:()=>({title:"Productos",route:"products",dialog:!1,snackbar:!1,text:"Registro Insertado",color:"success",timeout:4e3,search:"",imagePreview:"",valid:!0,headers:[{title:"Acciones",key:"actions",value:"actions",sortable:!1,width:"150px"},{title:"Cód.",filterable:!0,key:"code",width:"50px",class:"column-code"},{title:"Nombre",filterable:!0,key:"name"},{title:"Imagen",key:"image",sortable:!1},{title:"Precio Compra",key:"purchase_price"},{title:"Precio Venta",key:"sale_price"},{title:"Estado",key:"active",width:"150px"}],desserts:[],editedIndex:-1,vista:!1,categories:[],brands:[],editedItem:{id:"",name:"",code:"",category_id:null,brand_id:null,purchase_price:"",sale_price:"",image:"",imageFiles:[],active:1},defaultItem:{id:"",name:"",code:"",category_id:null,brand_id:null,purchase_price:"",sale_price:"",image:"",imageFiles:[],active:1},selectedHeaders:[]}),computed:{formTitle(){return this.editedIndex===-1?"Registrar Producto":"Editar Producto"},showHeaders(){return this.headers.filter(e=>this.selectedHeaders.includes(e))},filteredDesserts(){if(!this.search)return this.desserts;const e=this.search.toLowerCase();return this.desserts.filter(i=>{var f;return i.name.toLowerCase().includes(e)||((f=i.code)==null?void 0:f.toLowerCase().includes(e))})}},created(){this.$initialize(),this.selectedHeaders=this.headers,this.loadCategories(),this.loadBrands()},methods:{getImageInputValue(){return this.editedItem.imageFiles&&this.editedItem.imageFiles.length>0?this.editedItem.imageFiles:this.editedItem.image?[new File([],this.getImageName(),{type:"image/*"})]:[]},getImageName(){if(!this.editedItem.image)return"";const e=this.editedItem.image.split("/");return e.length>0?e.pop():""},async loadCategories(){try{const e=await this.$axios.get(this.$routes.categories);this.categories=e.data.data}catch(e){console.error("Error cargando categorías:",e)}finally{}},async loadBrands(){try{const e=await this.$axios.get(this.$routes.brands);this.brands=e.data.data}catch(e){console.error("Error cargando marcas:",e)}},formatCurrency(e){return e?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e):"$0.00"},handleImageUpload(e){var f;const i=(f=e.target.files)==null?void 0:f[0];this.imagePreview=i?URL.createObjectURL(i):""},clearImage(){this.editedItem.image="",this.editedItem.imageFiles=[],this.imagePreview=""},filterDessertName(e){return e.name.toLowerCase().includes(this.dessertName.toLowerCase())},filterByName(e){return this.$filterBy(e,"name")},filterByActive(e){return this.$filterBy(e,"active")}},watch:{dialog(e){e||this.$close()}}},Ke={key:1,class:"grey--text caption"},We={key:0},Ye={key:1},Je={key:1},Qe={class:"d-flex flex-wrap gap-1 align-center",style:{"min-width":"120px"}},Xe=["innerHTML"];function Ze(e,i,f,R,u,d){const o=De("IconBtn");return c(),y(N,{title:"Administración de "+e.title},{default:l(()=>[t(T,{class:"d-flex px-2"},{default:l(()=>[t(ve,{headers:d.showHeaders,items:d.filteredDesserts,search:e.search,class:"text-no-wrap striped-table"},{top:l(()=>[t(N,{flat:"",color:"white"},{default:l(()=>[t(T,null,{default:l(()=>[t(F,null,{default:l(()=>[t(s,{sm:"4",class:"pl-0 pt-20 py-2"},{default:l(()=>[t(P,{modelValue:e.search,"onUpdate:modelValue":i[0]||(i[0]=a=>e.search=a),"append-icon":"ri-search-line",label:"Busqueda de "+e.title},null,8,["modelValue","label"])]),_:1}),t(s,{sm:"4",class:"pt-20 py-2"},{default:l(()=>[t(H,{modelValue:e.selectedHeaders,"onUpdate:modelValue":i[1]||(i[1]=a=>e.selectedHeaders=a),items:e.headers,label:"Columnas Visibles",multiple:"","return-object":""},{selection:l(({item:a,index:m})=>[m<2?(c(),y(j,{key:0},{default:l(()=>[E("span",null,g(a.title),1)]),_:2},1024)):I("",!0),m===2?(c(),S("span",Ke," (otras "+g(e.selectedHeaders.length-2)+"+) ",1)):I("",!0)]),_:1},8,["modelValue","items"])]),_:1}),t(s,{sm:"1",class:"pt-20 py-2"},{default:l(()=>[t(Pe,{modelValue:e.dialog,"onUpdate:modelValue":i[13]||(i[13]=a=>e.dialog=a),"max-width":"50%"},{activator:l(({props:a})=>[t(b,$(a,{color:e.$cv("principal"),size:"x-large",title:"Registrar "+e.title}),{default:l(()=>[t(U,{size:"large",icon:"ri-add-circle-line"})]),_:2},1040,["color","title"])]),default:l(()=>[t(N,null,{default:l(()=>[t(ke,{color:e.$cv("principal")},{default:l(()=>[t(b,{icon:"ri-close-line",color:"white",onClick:i[2]||(i[2]=a=>e.dialog=!1)}),t(we,null,{default:l(()=>[h(g(d.formTitle),1)]),_:1})]),_:1},8,["color"]),t(Le,{ref:"form",modelValue:e.valid,"onUpdate:modelValue":i[10]||(i[10]=a=>e.valid=a)},{default:l(()=>[t(T,null,{default:l(()=>[t(Ee,{class:"py-0"},{default:l(()=>[t(F,{class:"py-0"},{default:l(()=>[t(s,{cols:"12",sm:"6"},{default:l(()=>[t(F,{class:"py-0"},{default:l(()=>[t(s,{cols:"12",sm:"12"},{default:l(()=>[t(P,{modelValue:e.editedItem.name,"onUpdate:modelValue":i[3]||(i[3]=a=>e.editedItem.name=a),label:"Nombre",required:""},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",sm:"12"},{default:l(()=>[t(P,{modelValue:e.editedItem.code,"onUpdate:modelValue":i[4]||(i[4]=a=>e.editedItem.code=a),label:"Código"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",sm:"12"},{default:l(()=>[t(H,{modelValue:e.editedItem.category_id,"onUpdate:modelValue":i[5]||(i[5]=a=>e.editedItem.category_id=a),items:e.categories,"item-title":"name","item-value":"id",label:"Categoría",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(s,{cols:"12",sm:"6"},{default:l(()=>[t(F,{class:"py-0"},{default:l(()=>[t(s,{cols:"12",sm:"12"},{default:l(()=>[t(H,{modelValue:e.editedItem.brand_id,"onUpdate:modelValue":i[6]||(i[6]=a=>e.editedItem.brand_id=a),items:e.brands,"item-title":"name","item-value":"id",label:"Marca",clearable:""},null,8,["modelValue","items"])]),_:1}),t(s,{cols:"12",sm:"12"},{default:l(()=>[t(P,{modelValue:e.editedItem.purchase_price,"onUpdate:modelValue":i[7]||(i[7]=a=>e.editedItem.purchase_price=a),label:"Precio de Compra",prefix:"$"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",sm:"12"},{default:l(()=>[t(P,{modelValue:e.editedItem.sale_price,"onUpdate:modelValue":i[8]||(i[8]=a=>e.editedItem.sale_price=a),label:"Precio de Venta",prefix:"$"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{class:"pr-3"},{default:l(()=>[t(s,{cols:"12",sm:"11",class:"pr-0"},{default:l(()=>[t(Oe,{modelValue:e.editedItem.imageFiles,"onUpdate:modelValue":i[9]||(i[9]=a=>e.editedItem.imageFiles=a),label:"Imagen del Producto","prepend-icon":"ri-image-line",accept:"image/*",onChange:d.handleImageUpload,clearable:!0,"show-size":!0,"truncate-length":15,"model-value":d.getImageInputValue()},{selection:l(({file:a})=>[a?(c(),S("span",We,g(a.name),1)):e.editedItem.image?(c(),S("span",Ye,g(d.getImageName()),1)):I("",!0)]),_:1},8,["modelValue","onChange","model-value"])]),_:1}),t(s,{cols:"12",sm:"1",class:"pl-1"},{default:l(()=>[e.editedItem.image&&typeof e.editedItem.image=="string"?(c(),y(b,{key:0,color:"error",size:"x-large",onClick:d.clearImage,class:"mt-0"},{default:l(()=>[t(U,{icon:"ri-delete-bin-line",class:"mr-1"})]),_:1},8,["onClick"])):I("",!0)]),_:1}),t(s,{cols:"12",sm:"12"},{default:l(()=>[e.imagePreview?(c(),y(M,{key:0,src:e.imagePreview,"max-height":"150",contain:"",class:"mt-2"},null,8,["src"])):I("",!0),e.editedItem.image?(c(),y(M,{key:1,src:"storage/products/"+e.editedItem.image,"max-height":"150",contain:"",class:"mt-2"},null,8,["src"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ge,null,{default:l(()=>[t(je),t(b,{text:"",onClick:i[11]||(i[11]=a=>e.dialog=!1)},{default:l(()=>[h("Cancelar")]),_:1}),t(b,{class:"bg-primary",color:"white",onClick:i[12]||(i[12]=a=>e.$saveWithFile())},{default:l(()=>[h("Guardar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),"item.image":l(({item:a})=>[a.image?(c(),y(M,{key:0,src:"/storage/products/"+a.image,"max-height":"50","max-width":"50",contain:""},null,8,["src"])):(c(),S("span",Je))]),"item.purchase_price":l(({item:a})=>[h(g(d.formatCurrency(a.purchase_price)),1)]),"item.sale_price":l(({item:a})=>[h(g(d.formatCurrency(a.sale_price)),1)]),"item.active":l(({item:a})=>[t(j,{color:e.$resolveStatusVariant(a.active).color,density:"comfortable"},{default:l(()=>[h(g(e.$resolveStatusVariant(a.active).text),1)]),_:2},1032,["color"])]),"item.actions":l(({item:a})=>[E("div",Qe,[t(o,{size:"small",class:"my-1",title:"Editar",onClick:m=>{e.vista=!1,e.$editItem(a.id)}},{default:l(()=>[t(U,{icon:"ri-pencil-line"})]),_:2},1032,["onClick"]),t(qe,{modelValue:a.active,"onUpdate:modelValue":m=>a.active=m,"true-value":1,"false-value":0,color:"primary","hide-details":"",title:"Activar o Inactivar",onClick:m=>e.$toggleActive(a)},null,8,["modelValue","onUpdate:modelValue","onClick"]),t(o,{size:"small",title:"Eliminar",class:"my-1",onClick:m=>{e.vista=!1,e.$deleteItem(a.id,a.name)}},{default:l(()=>[t(U,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])])]),_:1},8,["headers","items","search"]),t(Fe,{modelValue:e.snackbar,"onUpdate:modelValue":i[15]||(i[15]=a=>e.snackbar=a),bottom:!0,color:e.color,timeout:e.timeout},{action:l(({attrs:a})=>[t(b,$({dark:"",text:""},a,{onClick:i[14]||(i[14]=m=>e.snackbar=!1)}),{default:l(()=>[h("Cerrar")]),_:2},1040)]),default:l(()=>[E("div",{innerHTML:e.text},null,8,Xe)]),_:1},8,["modelValue","color","timeout"])]),_:1})]),_:1},8,["title"])}const wt=pe(Ge,[["render",Ze]]);export{wt as default};
